<!DOCTYPE html>
<html lang="en">
<head>
  <!-- ==================== Restrict Page Access Using Firebase Auth ==================== -->
  <!-- Hide page content immediately to prevent flickering before auth checks -->
   
  <style>

    html { display: none; }

    /* Hide DataTable's "Show entries" dropdown */
    div.dataTables_length {
      display: none;
    }

    /* Hide DataTable's search box  */
    div.dataTables_filter {
      display: none;
    }

  

     
  </style>
  <script>
document.addEventListener('DOMContentLoaded', () => {
  const partDetailModal = document.getElementById('partDetailModal');
  const parentModal = document.getElementById('editDefectModal');

  if (partDetailModal && parentModal) {
    partDetailModal.addEventListener('hidden.bs.modal', () => {
      const anyModalOpen = document.querySelectorAll('.modal.show').length > 0;

      if (anyModalOpen) {
        document.body.classList.add('modal-open');
      }

      // Prevent jump of parent modal
      parentModal.style.display = 'block';
    });
  }
});
</script>


  <!-- Authentication guard logic -->
  <script src="authguard.js" defer></script>
  <!-- ================================================================================== -->

  <!-- ==================== Meta Tags ==================== -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <title>Skyway Coach Lines</title>
  <!-- =================================================== -->

  <!-- ==================== Fonts & Icons ==================== -->
  <!-- Google Fonts - Nunito -->
  <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
  
  <!-- Font Awesome Icons -->
  <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <!-- ====================================================== -->

  <!-- ==================== CSS Styles ==================== -->
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

  <!-- DataTables Responsive Styling -->
  <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.4.1/css/responsive.bootstrap4.min.css">

  <!-- SB Admin 2 Custom Styles -->
  <link href="css/sb-admin-2.min.css" rel="stylesheet">

  <!-- DataTables Bootstrap Styling -->
  <link href="vendor/datatables/dataTables.bootstrap4.min.css" rel="stylesheet">

  <!-- Your Custom CSS -->
  <link href="css/custom.css" rel="stylesheet">
  <!-- ==================================================== -->

  <!-- ==================== JS Libraries ==================== -->
  <!-- DataTables Responsive Scripts -->
  <script src="https://cdn.datatables.net/responsive/2.4.1/js/dataTables.responsive.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.4.1/js/responsive.bootstrap4.min.js"></script>
  <!-- ======================================================= -->

  <!-- ==================== Firebase SDKs ==================== -->
  <!-- Use compat versions for simplicity -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <!-- Firebase Configuration -->
  <script src="firebase-config.js"></script>
  <!-- ======================================================== -->
</head>
<body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

            <!-- Sidebar - Brand -->
            <a class="sidebar-brand d-flex align-items-center justify-content-center" >
                <div class="sidebar-brand-icon rotate-n-15">
                    <i class="fas fa-laugh-wink"></i>
                </div>
                  <div class="sidebar-brand-text mx-3" id="userRoleDisplay">Role</div>
            </a>

            <!-- Divider -->
            <hr class="sidebar-divider my-0">

            <!-- Nav Item - Dashboard -->
            <li class="nav-item">
                <a class="nav-link" href="LandingPage.html">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Dashboard</span></a>
            </li>
        
            <!-- Divider -->
            <hr class="sidebar-divider">
            </li>
            <li class="nav-item active">
                <a class="nav-link" href="allDefectsc.html">
                    <i class="fas fa-chalkboard-teacher"></i> <!-- Good for teaching/lesson -->

                    <span>All Defects</span></a>
            </li>
<!-- Divider -->
            <hr class="sidebar-divider">
             <li class="nav-item active">
                <a class="nav-link" href="dayPlanner.html">
                    <i class="fas fa-file"></i> <!-- Good for teaching/lesson -->

                    <span>Day Planner</span></a>
            </li>

            <hr class="sidebar-divider">

                   <li class="nav-item">
  <a class="nav-link" href="completedRepair.html">
    <i class="fas fa-check-circle"></i> <!-- Icon suitable for completed work -->
    <span>Completed Repair</span>
  </a>
</li>
<hr class="sidebar-divider" id="whiteboardDivider">

 <li class="nav-item active" id="whiteboardMenuItem" style="display: none;">
  <a class="nav-link" href="whiteboard.html">
    <i class="fas fa-chalkboard"></i> <!-- Icon representing a whiteboard -->
    <span>Whiteboard</span>
  </a>
</li>
 <hr class="sidebar-divider" id="partsInventroyDivider">
                       
                      <li class="nav-item active" id="partsInventoryMenuItem" style="display: none;">
  <a class="nav-link" href="partsInventory.html">
    <i class="fas fa-boxes"></i> <!-- Appropriate icon for inventory/parts -->
    <span>Parts Inventory</span>
  </a>
</li>
             <hr class="sidebar-divider" id = "userManagementDivider">

             <li class="nav-item active"  id="userManagementMenuItem" style="display: none;">
                <a class="nav-link"  href="userManagement.html">
                    <i class="fas fa-users"></i> <!-- Good for teaching/lesson -->

                    <span>User Management    </span></a>
            </li>


            <!-- Divider -->
           
            

            <!-- Sidebar Toggler (Sidebar) -->
            <div class="text-center d-none d-md-inline">
                <button class="rounded-circle border-0" id="sidebarToggle"></button>
            </div>

        </ul>
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Topbar -->
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">

                  

                   
                    <!-- Topbar Navbar -->
                    <ul class="navbar-nav ml-auto">

                       

                       


                        

                        <!-- Nav Item - User Information -->
                        <li class="nav-item dropdown no-arrow">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<span class="mr-2 d-none d-lg-inline text-gray-600 small" id="userFirstName"></span>

                                <img class="img-profile rounded-circle"
                                    src="img/undraw_profile.svg">
                            </a>
                            <!-- Dropdown - User Information -->
                            <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                aria-labelledby="userDropdown">
                              
                               
                               
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">
                                    <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Logout
                                </a>
                            </div>
                        </li>

                    </ul>

                </nav>
                <!-- End of Topbar -->

                <!-- Begin Page Content -->
                <div class="container-fluid">
  
 <!-- ============================== Start: Defect Creation Inline Form ============================== -->

<h4 class="mb-3 text-primary">
  <i class="fas fa-calendar-alt"></i> Day Planner
</h4>

<form id="defectForm">
  <div class="form-row">
    
    <!-- Unit Number Input -->
    <div class="form-group col-md-3">
      <label for="unitNumber">Unit #</label>
      <input type="text" class="form-control" id="unitNumber" placeholder="e.g., 1234" required>
    </div>

    <!-- Mechanic Selector -->
    <div class="form-group col-md-4">
      <label for="recordedBySelect">Mechanics</label>
      <select class="form-control" id="recordedBySelect" required onchange="handleRecordedByChange(this)">
        <option value="" disabled selected>Select Mechanic</option>
        <option value="Anojan">Anojan</option>
        <option value="Gobi">Gobi</option>
        <option value="Jayano">Jayano</option>
        <option value="Sanker">Sanker</option>
        <option value="Pirasanna">Pirasanna</option>
        <option value="Matt">Matt</option>
        <option value="Sam">Sam</option>
        <option value="Maurice">Maurice</option>
        <option value="Amin">Amin</option>
        <option value="Ronald">Ronald</option>
        <option value="yukesh">yukesh</option>
      </select>

      <!-- Input shown when 'Other' is selected (optional feature) -->
      <input type="text" class="form-control mt-2" id="recordedByInput" placeholder="Enter mechanic name" style="display: none;">
    </div>

    <!-- Date Picker -->
    <div class="form-group col-md-3">
      <label for="recordedDate">Date</label>
      <input type="date" class="form-control" id="recordedDate" required>
    </div>

    <!-- Status Filter Dropdown -->
    <div class="form-group col-md-2">
      <label for="statusFilter">Filter by Status</label>
      <select class="form-control" id="statusFilter">
        <option value="">Select Status</option>
        <option value="Partially Completed">Partially Completed</option>
        <option value="Not Completed">Not Completed</option>
        <option value="Completed">Completed</option>
        <option value="Repair Not Needed">Repair Not Needed</option>
        <option value="Need Parts">Need Parts</option>
      </select>
    </div>

    <!-- Reset Filters Button -->
    <button type="button" class="btn btn-secondary mt-2" id="resetFiltersBtn">Reset Filters</button>
  </div>
</form>

<!-- Spacing between form and next section -->
<div style="margin-bottom: 10px;"></div>

<!-- =============================== End: Defect Creation Inline Form =============================== -->

    
 <!-- ============================== Start: DataTables Example ============================== -->

<div class="card shadow mb-4">
  
  <!-- Optional: Card header (if needed) -->
  <!-- <div class="card-header py-3">
    <h6 class="m-0 font-weight-bold text-primary">Defects Table</h6>
  </div> -->

  <div class="card-body">
    <div class="table-responsive">

      <!-- Main DataTable -->
      <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
        
        <!-- Table Header -->
        <thead>
          <tr>
            <th>Unit #</th>
            <th>Maintenance / Repairs Needed</th>
            <th>Date Captured</th>
            <th>Repair Date</th>
            <th>Estimated Time</th>
            <th>Mechanic</th>
            <th>KM</th>
            <th>Actual Time</th>
            <th>Mechanic Repair Notes</th>
            <th>Parts Used</th>
            <th>Parts to be Ordered</th>
            <th>Status</th>
            <th id="Column">Actions</th>
            <th id="hideColumn" style="display: none;">Manager's Approval</th>
          </tr>
        </thead>

        <!-- Table Body: Populated via JavaScript -->
        <tbody id="defect-table-body">
          <!-- JavaScript will insert rows here dynamically -->
        </tbody>

      </table>
    </div>
  </div>
</div>

<!-- =============================== End: DataTables Example =============================== -->

                </div>
                <!-- /.container-fluid -->
            </div>
            <!-- End of Main Page Content -->

<!---------------------------------------------Start of Edit Task Pop-view model ----------------------------------------------------->
<!-- Full Edit Task Modal -->
<div class="modal fade" id="editDefectModal" tabindex="-1" aria-labelledby="editDefectModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title fw-bold">Edit Task Details
          - <span id="defectIdLabel" class="text-primary"></span>
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <form id="editDefectForm">
          <input type="hidden" id="editDefectId">

          <!-- Top Inputs -->
          <div class="row g-3 mb-3">
            <div class="col-md-3">
              <label for="editRepairDate" class="form-label">Repair Date</label>
              <input type="date" class="form-control" id="editRepairDate">
            </div>
            <div class="col-md-3">
              <label for="editUnitNumber" class="form-label">Unit #</label>
              <input type="text" class="form-control" id="editUnitNumber" readonly>
            </div>
            <div class="col-md-3">
              <label for="editEstimatedTime" class="form-label">Estimated Time</label>
              <input type="number" class="form-control" id="editEstimatedTime">
            </div>
            <div class="col-md-3">
              <label for="editMechanic" class="form-label">Mechanic</label>
              <input type="text" class="form-control" id="editMechanic" readonly>
            </div>
          </div>
<div class="row g-3 mb-3">
  <div class="col-md-4">
    <label for="editKM" class="form-label">KM</label>
    <input type="text" class="form-control" id="editKM" required>
  </div>
  <div class="col-md-4">
    <label for="editActualTime" class="form-label">Actual Time</label>
    <input type="number" class="form-control" id="editActualTime" min="0" step="1" required>
  </div>
  <div class="col-md-4">
    <label for="editStatus" class="form-label">Status</label>
    <select class="form-select" id="editStatus" required>
      <option value="">Select Status</option>
      <option value="Partially Completed">Partially Completed</option>
      <option value="Completed">Completed</option>
      <option value="Repair Not Needed">Repair Not Needed</option>
      <option value="Need Parts">Need Parts</option>
    </select>
  </div>
</div>


          <!-- Text Fields -->
          <div class="mb-3">
            <label for="editIssue" class="form-label">Maintenance / Repairs Needed</label>
            <input type="text" class="form-control" id="editIssue">
          </div>
     
 
          
<!-- Previous Repair Notes container (hidden by default) -->
<div class="mb-3" id="previousNotesContainer" style="display:none;">
  <label class="form-label">Previous Repair Notes</label>
  <div id="previousMechanicNotes" 
       style="max-height: 200px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; border-radius: 5px;">
    <!-- Previous notes will be injected here -->
  </div>
</div>

<!-- New mechanic note input (always visible) -->
<div class="form-group">
  <label for="mechanicNoteInput">Mechanic Notes</label>
  <textarea id="mechanicNoteInput" class="form-control" rows="2" placeholder="Enter notes and press Enter..."></textarea>
  <ul id="mechanicNotesList" class="list-group mt-2"></ul>
</div>



          <!-- Parts Used -->
         <div class="mb-3">
  <label class="form-label">Parts Used</label>
  <table class="table table-bordered" id="partsUsedTable">
    <thead>
      <tr>
        <th>Part #</th>
        <th>Part Name</th>
        <th>Qty</th>
      
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="partsUsedBody">
      <!-- Dynamic rows -->
    </tbody>
  </table>
  <button type="button" class="btn btn-outline-primary btn-sm" onclick="addPartsRow('partsUsedBody')">+ Add Part</button>
</div>


          <!-- Parts to be Ordered -->
          <div class="mb-3">
            <label class="form-label">Parts to be Ordered</label>
            <table class="table table-bordered" id="partsOrderTable">
              <thead>
                <tr>
                  <th>Part #</th>
                  <th>Part Name</th>
                  <th>Qty</th>
                 
                 <th>Action</th>
                </tr>
              </thead>
              <tbody id="partsOrderBody">
                <!-- Dynamic rows -->
              </tbody>
            </table>
            <button type="button" class="btn btn-outline-warning btn-sm" onclick="addPartsRow('partsOrderBody')">+ Add Order</button>
          </div>

          <div class="text-end">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary">Save Changes</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>


<!---------------------------------------------End of Edit Task Pop-view model----------------------------------------------------->
   
<!---------------------------------- Start Part Detail View Modal--------------------------------------------------->
<div class="modal fade" id="partDetailModal" tabindex="-1" role="dialog" aria-labelledby="partDetailLabel" aria-hidden="true">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">

    <div class="modal-content">
      <div class="modal-header draggable"> <!-- 👈 Add class here -->
        <h5 class="modal-title" id="partDetailLabel"> Mechanic Work History</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="partDetailBody">
        <!-- Populated by JS -->
      </div>
    </div>
  </div>
</div>
<!---------------------------------- End Part Detail View Modal--------------------------------------------------->

 <!----------------------------------------------------------------------- Footer--------------------------->
            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                   <span>Copyright &copy; Skyway Coachlines 2025</span>
                    </div>
                </div>
            </footer>
<!------------------------------------------------------------------ End of Footer---------------------------->

        </div>
        <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    <!-- Logout Modal-->
    <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                    <a class="btn btn-primary" href="index.html">Logout</a>
                </div>
            </div>
        </div>

      </div>
     <!-- =========================== Start: JavaScript Includes =========================== -->

    <!-- jQuery (required before Bootstrap & plugins) -->
    <script src="vendor/jquery/jquery.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


    <!-- Bootstrap JS Bundle (includes Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- jQuery Easing Plugin -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- SB Admin 2 Template Scripts -->
    <script src="js/sb-admin-2.min.js"></script>

    <!-- DataTables Core Plugin -->
    <script src="vendor/datatables/jquery.dataTables.min.js"></script>

    <!-- DataTables Bootstrap 4 Integration -->
    <script src="vendor/datatables/dataTables.bootstrap4.min.js"></script>

    <!-- DataTables Custom Initialization (if used) -->
    <script src="js/demo/datatables-demo.js"></script>

    <!-- Custom Script: API config and main logic -->
    <script src="apiConfig"></script>          <!-- Replace with actual path if needed -->
    <script src="dayPlanner.js"></script>      <!-- Main logic for planner page -->
  <script>
 

</script>



    <!-- ============================ End: JavaScript Includes ============================ -->

</body>
</html>
